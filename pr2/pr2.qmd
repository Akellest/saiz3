---
title: "Использование технологии Yandex Query для анализа данных сетевой активности №2"
format:   
  md:
    output-file: README.md
editor_options: 
  chunk_output_type: inline
---

## Цель работы

1. Изучить возможности технологии Yandex DataLens для визуального анализа структурированных наборов данных
2. Получить навыки визуализации данных для последующего анализа с помощью сервисов Yandex Cloud
3. Получить навыки создания решений мониторинга/SIEM на базе облачных продуктов и открытых программных решений
4. Закрепить практические навыки использования SQL для анализа данных сетевой активности в сегментированной корпоративной сети

## Исходные данные

- Windows 11
- RStudio
- Yandex Cloud
- Yandex Query

## Общая ситуация

Для понимания сетевой обстановки и принятия решений по управлению информационной безопасностью Вам необходимо визуально представить результаты анализа информации, выполненной в YandexQuery с помощью продукта DataLens. Конкретнее – serverless решение в облаке YandexCloud.

Как и прежде, у Вас есть данные сетевой активности в корпоративной сети компании XYZ. Данные хранятся в Yandex Object Storage. Вы провели разведочный анализ данных и имеете представление о структуре данных.

Вам необходимо построить observability решение – средство визуального представления информации для мониторинга и оценки сетевой активности

## Задание

Используя сервис Yandex DataLens настроить доступ к результатам Yandex Query, полученным в ходе выполнения практической работы №1, и визуально представить результаты анализа данных.

## Задачи

1. Представить в виде круговой диаграммы соотношение внешнего и внутреннего сетевого трафика
2. Представить в виде столбчатой диаграммы соотношение входящего и исходящего трафика из внутреннего сетевого сегмента
3. Построить график активности (линейная диаграмма) объема трафика во времени
4. Все построенные графики вывести в виде единого дашборда в Yandex DataLens


## Ход работы

### 1. Настроить подключение к Yandex Query из DataLens

Переходим по ссылке

https://datalens.yandex.ru/

Выбираем: Подключения - Создать новое подключение - Yandex Query

![](images/1.png)

### 2. Создать из запроса YandexQuery датасет DataLens

Создаем датасет со своим соединением и своей таблицей

![](images/2.png)

### 3. Делаем нужные графики и диаграммы

Выбираем: Чарты - Создать чарт - Чарт

1. Представить в виде круговой диаграммы соотношение внешнего и внутреннего сетевого трафика

Запрос:

```{SQL}
IF (([src] LIKE '12.%' OR
    [src] LIKE '13.%' OR
    [src] LIKE '14.%')
    AND
    ([dst] LIKE '12.%' OR
    [dst] LIKE '13.%' OR
    [dst] LIKE '14.%'))
  THEN "Внутренний трафик"
ELSE
  "Внешний трафик"
END
```

Результат:

![](images/3.png)

2. Представить в виде столбчатой диаграммы соотношение входящего и исходящего трафика из внутреннего сетевого сегмента

Запрос:
```{SQL}
IF (LEFT([src], 3) IN ('12.', '13.', '14.') AND LEFT([dst], 3) NOT IN ('12.', '13.', '14.'))
    THEN 'Исходящий трафик'
ELSEIF (LEFT([dst], 3) IN ('12.', '13.', '14.') AND LEFT([src], 3) NOT IN ('12.', '13.', '14.'))
    THEN 'Входящий трафик'
END
```

Результат:

![](images/4.png)

3. Построить график активности (линейная диаграмма) объема трафика во времени

Запрос:

```{SQL}
IF (LEFT([src], 3) IN ('12.', '13.', '14.') AND LEFT([dst], 3) NOT IN ('12.', '13.', '14.'))
    THEN 'Исходящий трафик'
ELSEIF (LEFT([dst], 3) IN ('12.', '13.', '14.') AND LEFT([src], 3) NOT IN ('12.', '13.', '14.'))
    THEN 'Входящий трафик'
END
```

Результат:

![](images/5.png)

### 4. Составляем дашборд

![](images/6.png)

## Оценка результатов

Было настроено подлючение к Yandex Query из DataLens, созданы графики и диаграммы и дашборд

## Вывод

Поставленная задача была выполнена с использованием инструментов Yandex Query и RStudio. В процессе решения задачи был приобретен опыт работы с составлением графиков и дашбордов
